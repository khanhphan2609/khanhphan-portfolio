let menuIcon = document.querySelector('#menu-icon');
let navbar = document.querySelector('.navbar');
let sections = document.querySelectorAll('section');
let navLinks = document.querySelectorAll('header nav a');


window.onscroll = () => {
    sections.forEach(sec => {
        let top = window.scrollY;
        let offset = sec.offsetTop - 150;
        let height = sec.offsetHeight;
        let id = sec.getAttribute('id');

        if(top >= offset && top < offset + height) {
            navLinks.forEach(links => {
                links.classList.remove('active');
                document.querySelector('header nav a[href*= '+ id + ']').classList.add('active')
            })
        }
    })
}

menuIcon.onclick = () => {
    menuIcon.classList.toggle('bx-x');
    navbar.classList.toggle('active');
}


// Validate Form 
function validateForm() {
    var fullName = document.getElementById('fullName');
    var email = document.getElementById('email');
    var phoneNumber = document.getElementById('phoneNumber');
    var subject = document.getElementById('subject');
    var message = document.getElementById('message');
    var isValid = true;

    if (fullName.value.trim() === '') {
        document.getElementById('fullNameError').innerText = 'Please enter your full name.';
        fullName.classList.add('input-error');
        isValid = false;
    } else {
        document.getElementById('fullNameError').innerText = '';
        fullName.classList.remove('input-error');
        fullName.classList.add('input-success');
    }

    var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email.value)) {
        document.getElementById('emailError').innerText = 'Please enter a valid email address.';
        email.classList.add('input-error');
        isValid = false;
    } else {
        document.getElementById('emailError').innerText = '';
        email.classList.remove('input-error');
        email.classList.add('input-success');
    }

    if (phoneNumber.value.trim() === '') {
        document.getElementById('phoneNumberError').innerText = 'Please enter your phone number.';
        phoneNumber.classList.add('input-error');
        isValid = false;
    } else {
        document.getElementById('phoneNumberError').innerText = '';
        phoneNumber.classList.remove('input-error');
        phoneNumber.classList.add('input-success');
    }

    if (subject.value.trim() === '') {
        document.getElementById('subjectError').innerText = 'Please enter the subject.';
        subject.classList.add('input-error');
        isValid = false;
    } else {
        document.getElementById('subjectError').innerText = '';
        subject.classList.remove('input-error');
        subject.classList.add('input-success');
    }

    if (isValid) {
        document.getElementById('contactForm').submit();

        // Contact: Send to mail
        var emailBody = "Full Name: " + fullName.value + "\nEmail: " + email.value + "\nPhone Number: " + phoneNumber.value + "\nSubject: " + subject.value + "\n\nMessage: " + message;

        var emailLink = 'mailto:pvkhanh2609@gmail.com?subject=' + encodeURIComponent(subject.value) + '&body=' + encodeURIComponent(emailBody);
        window.location.href = emailLink;

        alert("You sent successfully!");
        fullName.value = '';
        email.value = '';
        phoneNumber.value = '';
        subject.value = '';
        message.value = ''; 
    }
}